1) 
SELECT FarmerID, Farmer."Name", Rating FROM Farmer NATURAL JOIN Market where CropName = 'wheat' AND Qtyremaining >= 100 AND Start_Price < 120;

2)
SELECT Farmer."Name", CropName, (Shelflife - (CURRENT_DATE - HarvestTime)) AS RemainingShelfLife 
FROM Farmer 
NATURAL JOIN Market 
NATURAL JOIN Crop 
WHERE (Shelflife - (CURRENT_DATE - HarvestTime)) > 0
ORDER BY RemainingShelfLife DESC
LIMIT 10;

3)Location Vali
SELECT Farmer."Name"
FROM FARMER
INNER JOIN LOCATION ON Farmer.LOCATIONID = Location.LOCATIONID
INNER JOIN BUYER ON Location.DISTRICT =
	(SELECT DISTRICT
		FROM LOCATION
		WHERE LOCATIONID = Buyer.LOCATIONID)
WHERE Buyer.BUYERID = 209;

4)
SELECT BUYERID,
	BUYER."Name",
	BIDAMOUNT
FROM BUYER
NATURAL JOIN BID
JOIN TRANSACTION ON BID.BIDID = TRANSACTION.BIDID
WHERE BID.QUANTITY >= 20
	AND BID.CROPNAME = 'Wheat'
	AND BID.BIDAMOUNT >= 22;

5)
SELECT count(FarmerID) FROM (
  SELECT FarmerID, sum(Bid.Quantity) AS Sold_Qty 
  FROM Market 
  NATURAL JOIN Bid 
  WHERE cropname = 'Wheat' AND Bid.Bidstatus = 'accepted' 
  GROUP BY FarmerID
) AS SoldQtyTable
WHERE Sold_Qty >= 10;


6)
SELECT BUYERID,
	QTYREQUIRED,
	PRICE,
	REQTIME
FROM CROPREQUESTED
WHERE CROPNAME = 'Millet'
	AND STATUS = 'available';

7)
SELECT BUYERID,
	BUYER.CITY,
	CROPNAME,
	PRICE,
	QTYREQUIRED
FROM CROPREQUESTED
NATURAL JOIN BUYER
NATURAL JOIN LOCATION
NATURAL JOIN
	(SELECT LOCATIONID,
			FARMERID
		FROM FARMER
		WHERE FARMERID = 12) AS F
WHERE STATUS = 'available';

8)

SELECT SUM(QTYREQUIRED * PRICE) AS TOTALMONEY
FROM CROPREQUESTED
WHERE BUYERID = 5
	AND REQTIME = '2022-02-02';

9)

SELECT FARMERID,
	SUM(TOTALPAYABLECHARGES) AS TOTALINCOME
FROM TRANSACTION
NATURAL JOIN BID
WHERE DATE(TRANSACTION.TRANSTIME) BETWEEN '2021-01-01' AND '2022-12-31'
	AND PAYMENTSTATUS = 'successful'
GROUP BY FARMERID;

10)
SELECT FARMERID,
	CROPNAME
FROM
	(SELECT FARMERID
		FROM LOCATION
		NATURAL JOIN FARMER
		WHERE "State" = 'Chhattisgarh'
			AND FARMER.RATING > 2) AS F
NATURAL JOIN FARMER
NATURAL JOIN MARKET
NATURAL JOIN CROP
WHERE CROPCATEGORY = 'Cereals';